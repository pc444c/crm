<!DOCTYPE html>
<html>
<head>
    <title>Создание тестового Excel с дубликатами</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <h2>Создание тестового Excel файла с дубликатами</h2>
    <button onclick="createTestFile()">Создать тест с дубликатами</button>
    <br><br>
    <button onclick="createTestFileAllDuplicates()">Создать тест со всеми дубликатами</button>
    
    <script>
    function createTestFile() {
        // Данные с некоторыми дубликатами
        const data = [
            ['Иван Петров', '79991234567', 'Москва', 25], // новый
            ['Петр Сидоров', '79991234567', 'СПб', 30],   // дубликат по телефону
            ['Анна Иванова', '79995556677', 'Казань', 28], // новый
            ['Олег Козлов', '79999998877', 'Тула', 35],   // новый
            ['Мария Петрова', '79995556677', 'Уфа', 22],  // дубликат по телефону
        ];
        
        const ws = XLSX.utils.aoa_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Лист1");
        
        XLSX.writeFile(wb, "test-some-duplicates.xlsx");
    }
    
    function createTestFileAllDuplicates() {
        // Данные где все телефоны уже существуют
        const data = [
            ['Новый Пользователь1', '79991234567', 'Москва', 25], // дубликат
            ['Новый Пользователь2', '79995556677', 'СПб', 30],     // дубликат
            ['Новый Пользователь3', '79999998877', 'Казань', 28],  // дубликат
        ];
        
        const ws = XLSX.utils.aoa_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Лист1");
        
        XLSX.writeFile(wb, "test-all-duplicates.xlsx");
    }
    </script>
</body>
</html>
